global:
  scrape_interval: '1m'
  scrape_timeout: '30s'
  evaluation_interval: '1m'

rule_files:
- '/etc/prometheus/rules/*.yaml'

scrape_configs:
- job_name: 'consul-agent-metrics'
  honor_timestamps: true
  metrics_path: '/v1/agent/metrics'
  scheme: 'http'
  params: 
    format: ['prometheus']  
  static_configs:
  - targets:
    - 'consul-server-1:8500'
    - 'consul-server-2:8500'
    - 'consul-server-3:8500'
- job_name: 'consul-exporter'
  honor_timestamps: true
  metrics_path: '/metrics'
  scheme: 'http'
  static_configs:
  - targets:
    - 'consul-exporter-consul-server-1:9107'
    - 'consul-exporter-consul-server-2:9107'
    - 'consul-exporter-consul-server-3:9107'
  metric_relabel_configs:
  - regex: '(instance)'
    replacement: '$1'
    action: 'labeldrop'